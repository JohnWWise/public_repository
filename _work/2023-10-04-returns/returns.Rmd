---
title: "FDOC Returns"
description: |
  This document is an ongoing investigation into the data available on individuals who have returned to prison. I choose not to use the term "recidivism" because it is often associated with a punitive and stigmatizing perspective on individuals who have been involved with the criminal legal system. The term implies a focus on reoffending and the idea of a "criminal" identity, rather than acknowledging the complex social, economic, and systemic factors at play.
output:
  distill::distill_article:
    toc: true
    toc_float: true
    toc_depth: 2
    df_print: paged
---
The Florida Department of Corrections makes its OBIS database accessible for public download [here](https://fdc.myflorida.com/pub/obis_request.html).

This document is an ONGOING mining of that data. Keep an eye out for my newsletter (which doesnâ€™t exist yet) for updates, or press f5 to refresh.

```{r libraries and seed, echo=TRUE}
# Packages utilized:
pkgs = c("readxl",
         "dplyr",
         "DT")
inst = lapply(pkgs, library, character.only = TRUE)
set.seed(8675309)
```

Since my github respoitory is being finicky about large file sizes and the size of the fdoc file of all releases on record is quite large, we limit ourselves to the data on returns for those who are currently incarcerated. That is, we look at everyone who is currently incarcerated and retuned to prison within one year of thier most recent release.

```{r}
base_dir <- "/Users/johnwise/Downloads"
Root <- read_excel(paste0(base_dir, "/Inmate_Active_2023-10.XLSX"))
Incarhist <- read_excel(paste0(base_dir, "/Inmate_Active_2023-10.XLSX"), sheet = 6)
```

```{r}
# Identify those who are in for first offense
first_timers <- Incarhist %>%
  arrange(DCNumber, desc(ReceiptDate)) %>%
  group_by(DCNumber) %>%
  mutate(row_num = row_number()) %>%
  filter(row_num <= 2) %>%
  select(-row_num) %>%
  count(DCNumber) %>%
  filter(n==1)
```

```{r}
# remove first-timers from analysis, filter for those out less than 1 year on most recent release
returners <- anti_join(Incarhist, first_timers, by ='DCNumber')
# grab the two most recent receipts of those who have returned
returners_current_and_last <- returners %>%
  arrange(DCNumber, desc(ReceiptDate)) %>%
  group_by(DCNumber) %>%
  mutate(row_num = row_number()) %>%
  filter(row_num <= 2) %>%
  select(-row_num)
```

```{r}
# discovering the amount of time each person was free last time they were out
returners_time_free <- returners_current_and_last %>%
  group_by(DCNumber) %>%
  summarise(TimeOut = as.numeric(difftime(max(ReceiptDate, na.rm = TRUE), max(ReleaseDate, na.rm = TRUE), units = "days")))
```

```{r}
# isolating those out less than one year on most recent release
short_out <- returners_time_free %>%
  filter(TimeOut <= 365)
```

```{r}
current_incarcerated_returned_less_1year <- merge(Root, short_out, by = 'DCNumber')
```

```{r}
# removing DCNumbers and names before public display
public <- current_incarcerated_returned_less_1year %>% select(-DCNumber, -FirstName, -LastName, -MiddleName, -BirthDate, -NameSuffix)
datatable(public, options = list(scrollX = TRUE, pageLength = 10, lengthMenu = c(10, 20, 50)))
```
To clarify, I have identified 4260 individuals who are currently incarcerated. These individuals had previously been incarcerated and were out for less than one year since their release from that previous incarceration. The analysis will begin shortly.
